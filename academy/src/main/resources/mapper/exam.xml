<?xml version="1.0" encoding="UTF-8"?><!--
	수정일          		수정자                          수정내용
  ===========      ========    =================
 *2025.02.00		rainend		시험문제은행관리
-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.academy.mapper.ExamMapper">

	<select id="selectExamList">
		SELECT exam_id, exam_nm, exam_year, exam_round, exam_open, exam_end, exam_period, exam_time, 
				is_use, use_flag, set_id, reg_dt, reg_id, upd_dt, upd_id
		FROM acm_exam_mst
		LIMIT #{recordCountPerPage} OFFSET #{firstIndex}
	</select>

	<select id="selectExamListTotCnt">
		SELECT COUNT(*) TOTAL_CNT
		FROM acm_exam_mst
	</select>

	<select id="selectExamDetail">
        SELECT exam_id, exam_nm, exam_year, exam_round, exam_open, exam_end, exam_period, exam_time, 
				is_use, use_flag, set_id, reg_dt, reg_id, upd_dt, upd_id
		FROM acm_exam_mst
		WHERE exam_id = #{examId}
	</select>

	<select id="selectExamQueList">
		select  aebi.que_id, aebi.que_title, aebi.que_desc, aebi.que_file_id, aebi.ans_file_id, aebi.pass_ans,
				aebi.que_range, aebi.que_level, aebi.que_count, aebi.que_type, aebi.pass_ans, aebi.ans_desc,
				aebi.is_use, aebi.reg_id, aebi.reg_dt, aebi.upd_id, aebi.upd_dt,
				aebi.ans_view1, aebi.ans_view2, aebi.ans_view3, aebi.ans_view4, aebi.ans_view5
		from acm_exam_mst aem, acm_exam_set aes, acm_exam_set_item aesi, acm_exam_bank_item aebi 
		where aem.SET_ID = aes.SET_ID
		and aes.SET_ID = aesi.SET_ID
		and aesi.QUE_ID = aebi.QUE_ID
		and aem.exam_id = #{examId}
	</select>

    <insert id="insertAnswer">
		INSERT INTO acm_exam_answer( 
			exam_id, IDENTY_ID, USER_ID, QUE_ID, ANSWER, REG_ID, REG_DT, UPD_ID, UPD_DT, CORRECT_YN
		) VALUES (
			#{examId}, #{identyId}, #{userId}, #{queId}, #{answer}, #{regId}, now(), #{updId}, now(), #{correctYn}
		)
    </insert>

</mapper>
